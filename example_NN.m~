% Solve a Pattern Recognition Problem with a Neural Network
% Script generated by NPRTOOL

% Sample Data Sets Avaiable in Matlab for Model Training 
% https://www.mathworks.com/help/deeplearning/gs/deep-learning-toolbox-sample-data-sets.html


% This script used Breast cancer dataset
load cancer_dataset
inputs = cancerInputs;
targets = cancerTargets;

% Create a Pattern Recognition Neural Network
% Construct a multilayer feedforward neural network
% Two hidden layers, the 1st hidden layger has 10 hidden unit
% the 2nd hidden layer has 20 hidden unit
hiddenLayerSize = [10 20]; 
net = patternnet(hiddenLayerSize);
% visualize the constructed neural network
view(net); 

% Set up Division of Data for Training, Validation, Testing
% More Information on Training, Validation, Testing: 
% https://towardsdatascience.com/train-validation-and-test-sets-72cb40cba9e7
net.divideParam.trainRatio = 70/100;
net.divideParam.valRatio = 15/100;
net.divideParam.testRatio = 15/100;

% Train the Network
[net,tr] = train(net,inputs,targets);

% Test the Network
outputs = net(inputs);
errors = gsubtract(targets,outputs);
performance = perform(net,targets,outputs)
 
% Plots
% Uncomment these lines to enable various plots.
figure, plotperform(tr)
figure, plottrainstate(tr)
figure, plotconfusion(targets,outputs)
figure, ploterrhist(errors)